<?xml version="1.0" encoding="UTF-8" ?>
<?eclipse version="3.0"?>

<plugin>
   <extension
         point="org.eclipse.imp.runtime.languageDescription">
      <language
            description="sdf2imp generic base language"
            extensions="sdf2impbase"
            language="DynamicRoot">
      </language>
   </extension>
   <extension
         id="org.strategoxt.imp.runtime.parser"
         name="Root Parser Wrapper"
         point="org.eclipse.imp.runtime.parser">
      <parser
            class="org.strategoxt.imp.runtime.dynamicloading.DynamicParseController"
            language="DynamicRoot">
      </parser>
   </extension>
   <extension
         point="org.eclipse.imp.runtime.tokenColorer">
      <tokenColorer
            class="org.strategoxt.imp.runtime.dynamicloading.DynamicTokenColorer"
            language="DynamicRoot">
      </tokenColorer>
   </extension>
   <extension
         point="org.eclipse.imp.runtime.referenceResolvers">
      <referenceResolver
            class="org.strategoxt.imp.runtime.dynamicloading.DynamicReferenceResolver"
            language="DynamicRoot">
      </referenceResolver>
   </extension>
   <extension
         point="org.eclipse.imp.runtime.foldingUpdater">
      <foldingUpdater
            class="org.strategoxt.imp.runtime.dynamicloading.DynamicFoldingUpdater"
            language="DynamicRoot">
      </foldingUpdater>
   </extension>
   <extension
         point="org.eclipse.imp.runtime.documentationProvider">
      <docProvider
            class="org.strategoxt.imp.runtime.services.DocumentationProvider"
            language="DynamicRoot">
      </docProvider>
   </extension>
   <extension
         point="org.eclipse.imp.runtime.autoEditStrategy">
      <autoEditStrategy
            class="org.strategoxt.imp.runtime.dynamicloading.DynamicAutoEditStrategy"
            language="DynamicRoot">
      </autoEditStrategy>
   </extension>
   <extension
         point="org.eclipse.imp.runtime.contentProposer">
      <proposer
            class="org.strategoxt.imp.runtime.dynamicloading.DynamicContentProposer"
            language="DynamicRoot">
      </proposer>
   </extension>
   
   <extension
         id="parsemarker"
         name="org.strategoxt.imp.runtime.parsemarker"
         point="org.eclipse.core.resources.markers">
    		<persistent value="true" />
        <super type="org.eclipse.core.resources.problemmarker"/>
        <super type="org.eclipse.core.resources.textmarker"/>
   </extension>
   
   <extension
         id="analysismarker"
         name="org.strategoxt.imp.runtime.analysismarker"
         point="org.eclipse.core.resources.markers">
    		<persistent value="true" />
            <super type="org.eclipse.core.resources.problemmarker"/>
            <super type="org.eclipse.core.resources.textmarker"/>
   </extension>
   
   <extension
      point="org.eclipse.ui.editors.annotationTypes">
   <type
      name="org.strategoxt.imp.runtime.parseerror"
      super="org.eclipse.ui.workbench.texteditor.error"
      markerType="org.strategoxt.imp.runtime.parsemarker"
      markerSeverity="2">
   </type>
   <type
      name="org.strategoxt.imp.runtime.parsewarning"
      super="org.eclipse.ui.workbench.texteditor.warning"
      markerType="org.strategoxt.imp.runtime.parsemarker"
      markerSeverity="1">
   </type>
   <type
      name="org.strategoxt.imp.runtime.analysiserror"
      super="org.eclipse.ui.workbench.texteditor.error"
      markerType="org.strategoxt.imp.runtime.analysismarker"
      markerSeverity="2">
   </type>
   <type
      name="org.strategoxt.imp.runtime.analysiswarning"
      super="org.eclipse.ui.workbench.texteditor.warning"
      markerType="org.strategoxt.imp.runtime.analysismarker"
      markerSeverity="1">
   </type>
   </extension>
   
   <extension point="org.eclipse.ui.ide.markerResolution">
      <markerResolutionGenerator
         markerType="org.strategoxt.imp.runtime.parsemarker"
         class="org.strategoxt.imp.runtime.parser.AmbSuggestionGenerator"/>
   </extension>

   <extension
         id="org.strategoxt.imp.runtime.parseerrormarkerspec"
         point="org.eclipse.ui.editors.markerAnnotationSpecification">
      <specification
            annotationType="org.strategoxt.imp.runtime.parseerror"
            textPreferenceKey="spiParseErrorAnnotationColor"
            textPreferenceValue="true"
            presentationLayer="6"
            showInNextPrevDropdownToolbarAction="true"
            label="Spoofax/IMP Parser Annotation"
            colorPreferenceKey="errorIndicationColor"
            showInNextPrevDropdownToolbarActionKey="showErrorInNextPrevDropdownToolbarAction"
            symbolicIcon="error"
            isGoToNextNavigationTargetKey="isErrorGoToNextNavigationTarget"
            isGoToPreviousNavigationTargetKey="isErrorGoToPreviousNavigationTarget"
            isGoToPreviousNavigationTarget="true"
            highlightPreferenceKey="errorIndicationHighlighting"
            highlightPreferenceValue="false"
            textStylePreferenceKey="errorTextStyle"
			textStylePreferenceValue="SQUIGGLES"             
            verticalRulerPreferenceKey="errorIndicationInVerticalRuler"
            verticalRulerPreferenceValue="true"
            overviewRulerPreferenceKey="errorIndicationInOverviewRuler"
            overviewRulerPreferenceValue="true"
            contributesToHeader="true"
            colorPreferenceValue="255,128,147"/>
   </extension>

   <!-- Note that post-deployment colors may differ from debug colors -->
   <extension
         id="org.strategoxt.imp.runtime.parsewarningmarkerspec"
         point="org.eclipse.ui.editors.markerAnnotationSpecification">
      <specification
            annotationType="org.strategoxt.imp.runtime.parsewarning"
            textPreferenceKey="spiParseErrorAnnotationColor"
            textPreferenceValue="true"
            presentationLayer="5"
            showInNextPrevDropdownToolbarAction="true"
            label="Spoofax/IMP Parser Warning Annotation"
            colorPreferenceKey="warningIndicationColor"
            showInNextPrevDropdownToolbarActionKey="showErrorInNextPrevDropdownToolbarAction"
            symbolicIcon="warning"
            isGoToNextNavigationTargetKey="isErrorGoToNextNavigationTarget"
            isGoToPreviousNavigationTargetKey="isErrorGoToPreviousNavigationTarget"
            isGoToPreviousNavigationTarget="true"
            highlightPreferenceKey="warningIndicationHighlighting"
            highlightPreferenceValue="false"
            textStylePreferenceKey="warningTextStyle"
			textStylePreferenceValue="SQUIGGLES"             
            verticalRulerPreferenceKey="warningIndicationInVerticalRuler"
            verticalRulerPreferenceValue="true"
            overviewRulerPreferenceKey="warningIndicationInOverviewRuler"
            overviewRulerPreferenceValue="true"
            contributesToHeader="true"
            colorPreferenceValue="255,148,127"/>
   </extension>

   <extension
         id="org.strategoxt.imp.runtime.analysiserrormarkerspec"
         point="org.eclipse.ui.editors.markerAnnotationSpecification">
      <specification
            annotationType="org.strategoxt.imp.runtime.analysiserror"
            colorPreferenceKey="spiAnalysisAnnotationColor"
            colorPreferenceValue="255,128,147"
            contributesToHeader="true"
            highlightPreferenceKey="analysisAnnotationHighlightKey"
            highlightPreferenceValue="false"
            includeOnPreferencePage="false"
            isGoToNextNavigationTarget="true"
            isGoToNextNavigationTargetKey="analysisAnnotationIsGotoNextKey"
            isGoToPreviousNavigationTarget="true"
            isGoToPreviousNavigationTargetKey="analysisAnnotationIsGotoPrevKey"
            label="Spoofax/IMP Analysis Annotation"
            overviewRulerPreferenceKey="analysisAnnotationOverviewKey"
            overviewRulerPreferenceValue="true"
            presentationLayer="7"
            showInNextPrevDropdownToolbarAction="true"
            symbolicIcon="error"
            textPreferenceKey="analysisErrorTextKey"
            textPreferenceValue="true"
            textStylePreferenceKey="analysisErrorTextStyleKey"
            textStylePreferenceValue="SQUIGGLES"
            verticalRulerPreferenceKey="analysisErrorVerticalKey"
            verticalRulerPreferenceValue="true"/>
   </extension>

   <extension
         id="org.strategoxt.imp.runtime.analysiswarningmarkerspec"
         point="org.eclipse.ui.editors.markerAnnotationSpecification">
      <specification
            annotationType="org.strategoxt.imp.runtime.analysiswarning"
            colorPreferenceKey="spiAnalysisAnnotationColor"
            colorPreferenceValue="255,148,127"
            contributesToHeader="true"
            highlightPreferenceKey="analysisAnnotationHighlightKey"
            highlightPreferenceValue="false"
            includeOnPreferencePage="false"
            isGoToNextNavigationTarget="true"
            isGoToNextNavigationTargetKey="analysisAnnotationIsGotoNextKey"
            isGoToPreviousNavigationTarget="true"
            isGoToPreviousNavigationTargetKey="analysisAnnotationIsGotoPrevKey"
            label="Spoofax/IMP Analysis Annotation"
            overviewRulerPreferenceKey="analysisWarningOverviewKey"
            overviewRulerPreferenceValue="true"
            presentationLayer="5"
            showInNextPrevDropdownToolbarAction="true"
            symbolicIcon="warning"
            textPreferenceKey="analysisWarningTextKey"
            textPreferenceValue="true"
            textStylePreferenceKey="analysisWarningTextStyleKey"
            textStylePreferenceValue="SQUIGGLES"
            verticalRulerPreferenceKey="analysisWarningVerticalKey"
            verticalRulerPreferenceValue="true"/>
   </extension>
   
   <extension
         point="org.eclipse.imp.runtime.annotationHover">
      <annotationHover
            class="org.strategoxt.imp.runtime.services.AnnotationHover"
            language="DynamicRoot">
      </annotationHover>
   </extension>
   
   <extension
         point="org.eclipse.imp.runtime.hoverHelper">
      <hoverHelper
            class="org.strategoxt.imp.runtime.services.AnnotationHoverHelper"
            language="DynamicRoot">
      </hoverHelper>
   </extension>

   <extension
         point="org.eclipse.ui.commands">
      <category
            id="org.strategoxt.imp.runtime.transformCommandCategory"
            name="Transform Command category">
      </category>
      <command
            categoryId="org.strategoxt.imp.runtime.transformCommandCategory"
            id="org.strategoxt.imp.runtime.transformCommand"
            name="Transform"
            description="Transform">
      </command>
      <command
            categoryId="org.eclipse.ui.category.textEditor"
            description="Go to definition"
            id="org.strategoxt.imp.runtime.resolveReferenceCommand"
            name="Go to definition">
      </command>
   </extension>
   <extension
         point="org.eclipse.ui.handlers">
      <handler
            class="org.strategoxt.imp.runtime.services.ReferenceResolverDelegate"
            commandId="org.strategoxt.imp.runtime.resolveReferenceCommand">
      </handler>
   </extension>
   <extension
         point="org.eclipse.ui.bindings">
      <key
            commandId="org.strategoxt.imp.runtime.transformCommand"
            contextId="org.eclipse.ui.textEditorScope"
            schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
            sequence="M1+T"/>
      <key
            commandId="org.strategoxt.imp.runtime.transformCommand"
            contextId="org.eclipse.ui.textEditorScope"
            schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
            sequence="CTRL+T"/>
      <key
            commandId="org.eclipse.ui.project.buildProject"
            contextId="org.eclipse.ui.contexts.window"
            sequence="M1+M3+B"
            schemeId="org.eclipse.ui.defaultAcceleratorConfiguration" />
      <key
            commandId="org.strategoxt.imp.runtime.resolveReferenceCommand"
            contextId="org.eclipse.ui.contexts.window"
            schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
            sequence="F3"/>
   </extension>
   <extension
         point="org.eclipse.ui.preferencePages">
      <page
            class="org.strategoxt.imp.runtime.SpoofaxPreferencePage"
            id="org.strategoxt.imp.runtime.SpoofaxPreferencePage"
            name="Spoofax">
      </page>
   </extension>
   <extension
         point="org.eclipse.core.runtime.preferences">
      <initializer
            class="org.strategoxt.imp.runtime.PreferenceInitializer">
      </initializer>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            allPopups="true"
            class="org.strategoxt.imp.runtime.services.RefactoringContributionFactory"
            locationURI="popup:org.eclipse.ui.popup.any?before=additions">
      </menuContribution>
   </extension>
   
      <extension
         point="org.eclipse.ui.editors">
      <editor
            name="Spoofax Editor"
            icon="icons/IMP-editor.gif"
            extensions="txt"
            contributorClass="org.eclipse.imp.editor.internal.TextEditorActionContributor"
            class="org.strategoxt.imp.runtime.editor.SpoofaxEditor"
            id="org.eclipse.imp.runtime.editor.spoofaxEditor">
      </editor>
   </extension>
      <extension
            point="org.eclipse.ui.ide.editorAssociationOverride">
         <editorAssociationOverride
               class="org.strategoxt.imp.runtime.editor.IMPEditorAssociationOverride"
               id="org.eclipse.imp.runtime.editor.spoofaxEditor">
         </editorAssociationOverride>
      </extension>
      <extension
            name="Toolbar Menus"
            point="org.eclipse.ui.menus">
         <menuContribution
               allPopups="false"
               locationURI="toolbar:org.eclipse.ui.main.toolbar?before=PerspectiveSpacer">
            <toolbar
                  id="org.spoofax.menus.toolbar">
               <command
                     commandId="org.spoofax.menus.toolbar.basecommand0"
                     label=" "
                     style="pulldown">
                  <parameter
                        name="org.spoofax.menus.menuID"
                        value="0">
                  </parameter>
                  <visibleWhen
                        checkEnabled="false">
                     <reference
                           definitionId="org.spoofax.menus.visibility">
                     </reference>
                  </visibleWhen>
               </command>
               <command
                     commandId="org.spoofax.menus.toolbar.basecommand1"
                     label=" "
                     style="pulldown">
                  <parameter
                        name="org.spoofax.menus.menuID"
                        value="1">
                  </parameter>
                  <visibleWhen
                        checkEnabled="false">
                     <reference
                           definitionId="org.spoofax.menus.visibility">
                     </reference>
                  </visibleWhen>
               </command>
               <command
                     commandId="org.spoofax.menus.toolbar.basecommand2"
                     label=" "
                     style="pulldown">
                  <parameter
                        name="org.spoofax.menus.menuID"
                        value="2">
                  </parameter>
                  <visibleWhen
                        checkEnabled="false">
                     <reference
                           definitionId="org.spoofax.menus.visibility">
                     </reference>
                  </visibleWhen>
               </command>
               <command
                     commandId="org.spoofax.menus.toolbar.basecommand3"
                     label=" "
                     style="pulldown">
                  <parameter
                        name="org.spoofax.menus.menuID"
                        value="3">
                  </parameter>
                  <visibleWhen
                        checkEnabled="false">
                     <reference
                           definitionId="org.spoofax.menus.visibility">
                     </reference>
                  </visibleWhen>
               </command>
               <command
                     commandId="org.spoofax.menus.toolbar.basecommand4"
                     label=" "
                     style="pulldown">
                  <parameter
                        name="org.spoofax.menus.menuID"
                        value="4">
                  </parameter>
                  <visibleWhen
                        checkEnabled="false">
                     <reference
                           definitionId="org.spoofax.menus.visibility">
                     </reference>
                  </visibleWhen>
               </command>
               <command
                     commandId="org.spoofax.menus.toolbar.basecommand5"
                     label=" "
                     style="pulldown">
                  <parameter
                        name="org.spoofax.menus.menuID"
                        value="5">
                  </parameter>
                  <visibleWhen
                        checkEnabled="false">
                     <reference
                           definitionId="org.spoofax.menus.visibility">
                     </reference>
                  </visibleWhen>
               </command>
            </toolbar>
         </menuContribution>
         <menuContribution
               allPopups="false"
               locationURI="menu:org.spoofax.menus.toolbar.basecommand0">
            <dynamic
                  class="org.strategoxt.imp.runtime.services.menus.DynamicContributionItem"
                  id="org.spoofax.menus.toolbar.menu.contributions0">
            </dynamic>
         </menuContribution>
         <menuContribution
               allPopups="false"
               locationURI="menu:org.spoofax.menus.toolbar.basecommand1">
            <dynamic
                  class="org.strategoxt.imp.runtime.services.menus.DynamicContributionItem"
                  id="org.spoofax.menus.toolbar.menu.contributions1">
            </dynamic>
         </menuContribution>
         <menuContribution
               allPopups="false"
               locationURI="menu:org.spoofax.menus.toolbar.basecommand2">
            <dynamic
                  class="org.strategoxt.imp.runtime.services.menus.DynamicContributionItem"
                  id="org.spoofax.menus.toolbar.menu.contributions2">
            </dynamic>
         </menuContribution>
         <menuContribution
               allPopups="false"
               locationURI="menu:org.spoofax.menus.toolbar.basecommand3">
            <dynamic
                  class="org.strategoxt.imp.runtime.services.menus.DynamicContributionItem"
                  id="org.spoofax.menus.toolbar.menu.contributions3">
            </dynamic>
         </menuContribution>
         <menuContribution
               allPopups="false"
               locationURI="menu:org.spoofax.menus.toolbar.basecommand4">
            <dynamic
                  class="org.strategoxt.imp.runtime.services.menus.DynamicContributionItem"
                  id="org.spoofax.menus.toolbar.menu.contributions4">
            </dynamic>
         </menuContribution>
         <menuContribution
               allPopups="false"
               locationURI="menu:org.spoofax.menus.toolbar.basecommand5">
            <dynamic
                  class="org.strategoxt.imp.runtime.services.menus.DynamicContributionItem"
                  id="org.spoofax.menus.toolbar.menu.contributions5">
            </dynamic>
         </menuContribution>
      </extension>
      <extension
            point="org.eclipse.ui.commands">
         <command
               defaultHandler="org.strategoxt.imp.runtime.services.menus.ActionHandler"
               id="org.spoofax.menus.action"
               name="spoofaxaction">
            <commandParameter
                  id="org.spoofax.menu.path"
                  name="path"
                  optional="false">
            </commandParameter>
         </command>
         <command
               defaultHandler="org.strategoxt.imp.runtime.services.menus.ToolbarBaseCommandHandler"
               id="org.spoofax.menus.toolbar.basecommand0"
               name="toolbarMenuBaseCommand0">
            <commandParameter
                  id="org.spoofax.menus.menuID"
                  name="menuID"
                  optional="false">
            </commandParameter>
         </command>
         <command
               defaultHandler="org.strategoxt.imp.runtime.services.menus.ToolbarBaseCommandHandler"
               id="org.spoofax.menus.toolbar.basecommand1"
               name="toolbarMenuBaseCommand1">
            <commandParameter
                  id="org.spoofax.menus.menuID"
                  name="menuID"
                  optional="false">
            </commandParameter>
         </command>
         <command
               defaultHandler="org.strategoxt.imp.runtime.services.menus.ToolbarBaseCommandHandler"
               id="org.spoofax.menus.toolbar.basecommand2"
               name="toolbarMenuBaseCommand2">
            <commandParameter
                  id="org.spoofax.menus.menuID"
                  name="menuID"
                  optional="false">
            </commandParameter>
         </command>
         <command
               defaultHandler="org.strategoxt.imp.runtime.services.menus.ToolbarBaseCommandHandler"
               id="org.spoofax.menus.toolbar.basecommand3"
               name="toolbarMenuBaseCommand3">
            <commandParameter
                  id="org.spoofax.menus.menuID"
                  name="menuID"
                  optional="false">
            </commandParameter>
         </command>
         <command
               defaultHandler="org.strategoxt.imp.runtime.services.menus.ToolbarBaseCommandHandler"
               id="org.spoofax.menus.toolbar.basecommand4"
               name="toolbarMenuBaseCommand4">
            <commandParameter
                  id="org.spoofax.menus.menuID"
                  name="menuID"
                  optional="false">
            </commandParameter>
         </command>
         <command
               defaultHandler="org.strategoxt.imp.runtime.services.menus.ToolbarBaseCommandHandler"
               id="org.spoofax.menus.toolbar.basecommand5"
               name="toolbarMenuBaseCommand5">
            <commandParameter
                  id="org.spoofax.menus.menuID"
                  name="menuID"
                  optional="false">
            </commandParameter>
         </command>
      </extension>
      <extension
            point="org.eclipse.core.expressions.definitions">
         <definition
               id="org.spoofax.menus.visibility">
            <with
                  variable="activePart">
               <test
                     forcePluginActivation="true"
                     property="org.strategoxt.imp.runtime.menuEnabled">
               </test>
            </with>
         </definition>
      </extension>
      <extension
            point="org.eclipse.core.expressions.propertyTesters">
         <propertyTester
               class="org.strategoxt.imp.runtime.services.menus.MenuEnabledTester"
               id="org.spoofax.menus.menuEnabledTester"
               namespace="org.strategoxt.imp.runtime"
               properties="menuEnabled"
               type="org.strategoxt.imp.runtime.editor.SpoofaxEditor">
         </propertyTester>
      </extension>
      
      <extension
         point="org.eclipse.core.runtime.adapters">
      <factory
            adaptableType="org.spoofax.interpreter.terms.IStrategoTerm"
            class="org.strategoxt.imp.runtime.editor.StrategoTermAdapterFactory">
         <adapter
               type="org.eclipse.ui.views.properties.IPropertySource">
         </adapter>
      </factory>
   </extension>
</plugin>

